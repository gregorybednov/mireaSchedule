# mireaSchedule
Скрипт скачивания и парсинга расписания МИРЭА (по состоянию на 2023 год) в текстовую форму

# Установка

Посмотрите релизы (Releases), чтобы скачать .exe файл для Windows.

***

Для GNU/Linux и прочих систем (macOS, FreeBSD) предлагается ручная установка.
Для этого предполагается удовлетворить зависимости проекта (можно установить через ```pip install```):

- ```aiothttp``` для скачивания таблиц с официального сайта МИРЭА,
- ```openpyxl``` для обработки этих таблиц,
- ```pysimplegui``` для графического интерфейса утилиты.

Также используются модули ```asyncio```, ```re```, ```sys```, ```functools```,
которые обычно входят в стандартную поставку Python и в отдельной установке не нуждаются.

# Использование

При использовании графического интерфейса предлагается ввести строку текста.
Будут найдены занятия, имеющие данную строку в ячейках (это может быть фамилия
и инициалы преподавателя, аудитория в том же формате, что в и оригинальном файле
расписания, или официальное название предмета). 

Если занятий не найдено, то будет выведено соответствующее сообщение и файл создаваться не будет.

Если найдены, то они будут экспортированы в формате CSV c разделителем **; (точка с запятой)**.
Просмотр можно настроить в Excel или Calc, в принципе файлы CSV можно открывать хоть в Блокноте.

Если в поле ввода ничего не вводить, то в таблицу будут выведены *все* занятия в расписаниях институтов ИТ и ИИ.

***
Также существует текстовый режим для работы в терминале, он вызывается аргументом командной строки ```--text-mode```
и не поддерживает фильтров (предполагается, что фильтры пользователь может реализовать через grep и подобные стандартные инструменты)

# Принцип работы

1. Утилита скачивает xlsx-файлы, помеченные как IIT и III (относящиеся к ИИТ и ИИИ) с официального сайта mirea.ru/schedule

2. Затем "конструирует" из человекочитаемой xlsx-таблицы (точнее, всех таблиц) длиннный "список" из всех существующих занятий.
Именно эта операция отнимает максимум времени.

3. После этого применяется поиск (точный, как в расписании) по записям "списка"
4. Подходящие записи остаются в файл "текстовых таблиц" CSV
