# mireaSchedule

Скрипт (точнее, теперь уже программа) для автоматического скачивания и парсинга расписания МИРЭА (по состоянию на 2023 год) в текстовую и табличную (CSV) форму.

# Установка

Посмотрите релизы (Releases), чтобы скачать .exe файл для Windows под платформу amd64.

Для GNU/Linux необходима ручная установка прогарммы ```zenity``` для отображения диалоговых окон.

# Использование

При использовании графического интерфейса предлагается ввести строку текста.
Будут найдены занятия, имеющие данную строку в ячейках (это может быть фамилия
и инициалы преподавателя, аудитория в том же формате, что в и оригинальном файле
расписания, или официальное название предмета). 

Далее будет предложено сохранить файл с таким же названием как и запрос, но название в этот момент можно изменить. Все найденные занятия списком экспортируются в текстово-табличном формате CSV c разделителем  **; (точка с запятой)**. Просмотр можно настроить в Excel или Calc, в принципе файлы CSV можно открывать хоть в Блокноте.

Также запросы можно совмещать (по ИЛИ), и в таком случае будет выведено объединение множеств, соответствующих первому запросу и второму. Соединение происходит по символу **~ (тильда)**. Пример запроса: *Иванов В.А.~Петров А.Б.* выдаст все занятия, проводимые Ивановым В.А. и Петровым А.Б., а *Сергеев М.О.~ИКБО-99-24* выдаст пары, проводимые Сергеевым М.О. и пары, которые поставлены у ИКБО-99-24.

~~Если занятий не найдено, то будет выведено соответствующее сообщение и файл создаваться не будет.~~ По состоянию на 7 сен скрипт был полностью переписан, данная функция будет восстановлена.


Если в поле ввода ничего не вводить, то в таблицу будут выведены *все* занятия в расписаниях институтов ИТ и ИИ, но сохранить файл с пустым именем, вероятнее всего, вам не даст операционная система.

~~Также существует текстовый режим для работы в терминале, он вызывается аргументом командной строки ```--text-mode``` и не поддерживает фильтров (предполагается, что фильтры пользователь может реализовать через grep и подобные стандартные инструменты)~~ будет восстановлен в следующих версиях

# Принцип работы

1. Утилита скачивает xlsx-файлы, помеченные как IIT и III (относящиеся к ИИТ и ИИИ) с официального сайта mirea.ru/schedule
2. Затем "конструирует" из человекочитаемой xlsx-таблицы (точнее, всех таблиц) длиннный "список" из всех существующих занятий.
3. После этого применяется поиск (точный, как в расписании) по записям "списка". При наличии нескольких запросов, совмещенных через тильду, удовлетворение записью в расписании хотя бы одного запроса считается достаточным, чтобы вывести их в итоговый файл.
4. Подходящие записи остаются в файл "текстовых таблиц" CSV
